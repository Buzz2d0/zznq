<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>å®‰å…¨å¼€å‘ on zznQ</title><link>https://zznq.imipy.com/categories/%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91/</link><description>Recent content in å®‰å…¨å¼€å‘ on zznQ</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Tue, 25 May 2021 00:00:00 +0000</lastBuildDate><atom:link href="https://zznq.imipy.com/categories/%E5%AE%89%E5%85%A8%E5%BC%80%E5%8F%91/index.xml" rel="self" type="application/rss+xml"/><item><title>golang web audit å°è®°</title><link>https://zznq.imipy.com/posts/golang-web-audit/</link><pubDate>Tue, 25 May 2021 00:00:00 +0000</pubDate><guid>https://zznq.imipy.com/posts/golang-web-audit/</guid><description>&lt;p>ç®€å•è®°å½•ä¸‹Golang webä»£ç å®¡è®¡ã€‚&lt;/p></description></item><item><title>cgo &amp; objc</title><link>https://zznq.imipy.com/posts/cgoobjc/</link><pubDate>Mon, 17 May 2021 00:00:00 +0000</pubDate><guid>https://zznq.imipy.com/posts/cgoobjc/</guid><description>æˆ‘å°è¯•ç”¨ golang ç¼–å†™ä¸€äº›æ ¸å¿ƒä»£ç ï¼Œå†åˆ©ç”¨ cgo çš„ç‰¹æ€§å°†å…¶æ‰“åŒ…æˆ dylib æ–‡ä»¶ï¼Œä»¥ä¾¿äºæˆ‘åœ¨objc ä¸­è°ƒç”¨ï¼ˆå› ä¸ºæˆ‘ objc å†™çš„å¾ˆçƒ‚ï¼‰ã€‚
å…ˆå†™ä¸ªå¾ˆç®€å•çš„ cgo ç¨‹åº main.go ï¼š
package main //void HelloWorld(); import &amp;#34;C&amp;#34; import &amp;#34;fmt&amp;#34; //export HelloWorld func HelloWorld() { fmt.Println(&amp;#34;Hello World!!!&amp;#34;) } func main() {} ä»£ç ä¸­æœ‰å‡ ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ä¸‹ï¼š
import &amp;quot;C&amp;quot; è¯­å¥åˆ™è¡¨ç¤ºå¼€å¯äº†CGOç‰¹æ€§ //export HelloWorld CGO æŒ‡ä»¤å°†å…¶å¯¼å‡ºä¸ºCè¯­è¨€å‡½æ•° ç¼–è¯‘ä¸ºdylibåŠ¨æ€åº“ï¼š $ go build -buildmode=c-shared--ldflags=&amp;quot;-w -s&amp;quot; -o cgodemo.dylib cgoDemo/main.go
æŸ¥çœ‹ä¸‹æ–‡ä»¶ä¿¡æ¯ï¼š
$ file cgodemo.dylib cgodemo.dylib: Mach-O 64-bit dynamically linked shared library x86_64 $ otool -L cgodemo.</description></item><item><title>cel-go åˆæ¢</title><link>https://zznq.imipy.com/posts/cel-go-demo/</link><pubDate>Wed, 12 May 2021 00:00:00 +0000</pubDate><guid>https://zznq.imipy.com/posts/cel-go-demo/</guid><description>ä¹‹å‰çœ‹åˆ° Xray - å¦‚ä½•ç¼–å†™expressionè¡¨è¾¾å¼ æåˆ°è¿™ä¸ªåº“ https://github.com/google/cel-spec
æ­£å¥½å·¥ä½œæ–¹é¢ä¹Ÿé‡åˆ°è¿™ä¸ªéœ€æ±‚äº†ï¼Œå°±æ¥ç®€å•çš„ç ”ç©¶ä¸‹ï¼Œå…ˆçœ‹ä¸‹ç›¸å…³èµ„æ–™ï¼š
cel-spec ä»‹ç» cel-go github cel-go å…¥é—¨æ–‡æ¡£ cel æ˜¯å»ºç«‹ protocol ä¹‹ä¸Šçš„ã€‚
åœ¨ demo é¡¹ç›®ä¸‹åˆ›å»º fprint åŒ…ï¼›å¹¶åœ¨å…¶ç›®å½•ä¸‹åˆ›å»º fprint.proto æ–‡ä»¶
syntax = &amp;#34;proto3&amp;#34;;package fprint; // https://developers.google.com/protocol-buffers/docs/proto3#packages option go_package = &amp;#34;fprint/bp&amp;#34;; // golang package åŒ…å message Response { string url = 1; int32 status = 2 ; map&amp;lt;string, string&amp;gt; headers = 3; string content_type = 4; string title = 5; bytes body = 6; string md5 = 7;}ä½¿ç”¨ $ protoc --go_out=.</description></item><item><title>Linux ptraceæœºåˆ¶åˆæ¢</title><link>https://zznq.imipy.com/posts/linux-ptrace-learning/</link><pubDate>Thu, 10 Dec 2020 00:00:00 +0000</pubDate><guid>https://zznq.imipy.com/posts/linux-ptrace-learning/</guid><description>è¡¥å……ä¸‹åŸºç¡€çŸ¥è¯† åŠ¨æ€åŠ è½½ åŠ¨æ€åŠ è½½Dynamic Loadingï¼šæ˜¯ä¸€ç§ç¨‹åºè¿è¡Œæœºåˆ¶ï¼Œèƒ½è®©è®¡ç®—æœºç¨‹åºåœ¨è¿è¡Œæ—¶ï¼ˆè€Œä¸æ˜¯ç¼–è¯‘æ—¶ï¼‰è£…è½½åº“ï¼ˆæˆ–è€…å…¶ä»–äºŒè¿›åˆ¶å¯¹è±¡ï¼‰åˆ°å†…å­˜ä¸­ï¼Œç„¶åæ£€ç´¢åº“ä¸­å‡½æ•°å’Œå˜é‡çš„åœ°å€ï¼Œå¹¶è¿è¡Œè¿™äº›å‡½æ•°æˆ–è®¿é—®è¿™äº›å˜é‡ï¼Œä¸”èƒ½åœ¨ä¸éœ€è¦æ—¶å°†åº“ä»å†…å­˜ä¸­å¸è½½ã€‚
linuxä¸‹çš„/procè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ Linux å†…æ ¸æä¾›äº†ä¸€ç§é€šè¿‡ /proc æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨è¿è¡Œæ—¶è®¿é—®å†…æ ¸å†…éƒ¨æ•°æ®ç»“æ„ã€æ”¹å˜å†…æ ¸è®¾ç½®çš„æœºåˆ¶ã€‚procæ–‡ä»¶ç³»ç»Ÿæ˜¯ä¸€ä¸ªä¼ªæ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒåªå­˜åœ¨å†…å­˜å½“ä¸­ï¼Œè€Œä¸å ç”¨å¤–å­˜ç©ºé—´ã€‚å®ƒä»¥æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼ä¸ºè®¿é—®ç³»ç»Ÿå†…æ ¸æ•°æ®çš„æ“ä½œæä¾›æ¥å£ã€‚
/proc/&amp;lt;PID&amp;gt;/status / /proc/&amp;lt;PID&amp;gt;/statï¼š æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ /proc/&amp;lt;PID&amp;gt;/mapsï¼šè¿›ç¨‹å…³è”åˆ°çš„æ¯ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å’Œåº“æ–‡ä»¶åœ¨å†…å­˜ä¸­çš„æ˜ å°„åŒºåŸŸåŠå…¶è®¿é—®æƒé™æ‰€ç»„æˆçš„åˆ—è¡¨ /proc/self/mapsï¼š å½“å‰è¿›ç¨‹çš„å†…å­˜æ˜ å°„å…³ç³»ï¼Œé€šè¿‡è¯»è¯¥æ–‡ä»¶çš„å†…å®¹å¯ä»¥å¾—åˆ°å†…å­˜ä»£ç æ®µåŸºå€ã€‚ ä»€ä¹ˆæ˜¯ Ptraceï¼Ÿ é€šè¿‡ä½¿ç”¨ ptraceï¼ˆåç§°æ˜¯ &amp;ldquo;process trace&amp;rdquo; çš„ç¼©å†™ï¼‰ï¼Œä¸€ä¸ªè¿›ç¨‹å¯ä»¥æ§åˆ¶å¦ä¸€ä¸ªè¿›ç¨‹ï¼Œä»è€Œä½¿æ§åˆ¶å™¨èƒ½å¤Ÿæ£€æŸ¥å’Œæ“çºµç›®æ ‡çš„å†…éƒ¨çŠ¶æ€ã€‚
linux ptrace å‡½æ•°æä¾›äº†è®¸å¤šæœ‰ç”¨çš„è°ƒè¯•æ“ä½œï¼š
PTRACE_ATTACH å…è®¸ä¸€ä¸ªè¿›ç¨‹å°†è‡ªèº«é™„åŠ åˆ°å¦ä¸€ä¸ªè¿›ç¨‹è¿›è¡Œè°ƒè¯•ï¼Œä»è€Œæš‚åœè¿œç¨‹è¿›ç¨‹ã€‚ PTRACE_PEEKTEXT å…è®¸ä»å¦ä¸€ä¸ªè¿›ç¨‹åœ°å€ç©ºé—´è¯»å–å†…å­˜ã€‚ PTRACE_POKETEXT å…è®¸å°†å†…å­˜å†™å…¥å¦ä¸€ä¸ªè¿›ç¨‹åœ°å€ç©ºé—´ã€‚ PTRACE_GETREGS ä»è¿›ç¨‹ä¸­è¯»å–å½“å‰çš„å¤„ç†å™¨å¯„å­˜å™¨é›†ã€‚ PTRACE_SETREGS å†™å…¥è¿›ç¨‹çš„å½“å‰å¤„ç†å™¨å¯„å­˜å™¨é›†ã€‚ PTRACE_CONT æ¢å¤é™„åŠ è¿›ç¨‹çš„æ‰§è¡Œã€‚ PTRACE_DETACH æ˜¯é‡æ–°å¯åŠ¨æ“ä½œï¼›å®ƒè¦æ±‚ç›®æ ‡è¿›ç¨‹å¤„äº ptrace-stop ä¸­ã€‚ å‡½æ•°ç­¾åï¼š
long ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data); ğŸŒ° ï¼ˆLinux ubuntu 4.15.0-112-generic x86_64ï¼‰:
#include &amp;lt;stdio.h&amp;gt;#include &amp;lt;sys/types.h&amp;gt;#include &amp;lt;sys/wait.h&amp;gt;#include &amp;lt;sys/ptrace.h&amp;gt;#include &amp;lt;unistd.h&amp;gt;#include &amp;lt;sys/user.h&amp;gt; int main(int argc, char **argv) { int child_pid; child_pid = fork(); if (child_pid == 0) { // `PTRACE_TRACEME` æœ¬è¿›ç¨‹å°†è¢«å…¶çˆ¶è¿›ç¨‹è·Ÿè¸ª(æ­¤æ—¶å‰©ä¸‹çš„`pidã€addrã€data`å‚æ•°éƒ½æ²¡æœ‰å®é™…æ„ä¹‰å¯ä»¥å…¨éƒ¨ä¸º 0)ã€‚ ptrace(PTRACE_TRACEME, 0, 0, 0); execl(&amp;#34;/bin/ls&amp;#34;,&amp;#34;ls&amp;#34;,NULL); //æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ } else { struct user_regs_struct regs; wait(NULL); printf(&amp;#34;child process was stopped .</description></item><item><title>è¢«åŠ¨æ‰«æå™¨HTTP(S)ä»£ç†åˆæ¢</title><link>https://zznq.imipy.com/posts/passive-scanner-https-proxy/</link><pubDate>Fri, 20 Nov 2020 00:00:00 +0000</pubDate><guid>https://zznq.imipy.com/posts/passive-scanner-https-proxy/</guid><description>å¦‚ä½•ä»£ç† http(s) æµé‡ HTTP ä»£ç†çš„åè®®åŸºäº HTTPï¼Œå› æ­¤ HTTP ä»£ç†æœ¬èº«å°±æ˜¯ä¸€ä¸ª HTTP çš„æœåŠ¡ï¼Œè€Œå…¶å·¥ä½œåŸç†æœ¬è´¨ä¸Šå°±æ˜¯ä¸­é—´äººï¼ˆMITM) ï¼Œå³è¯»å–å½“å‰å®¢æˆ·ç«¯çš„ HTTP è¯·æ±‚ï¼Œä»ä»£ç†å‘é€å‡ºå»å¹¶è·å¾—å“åº”ï¼Œç„¶åå°†å“åº”è¿”å›ç»™å®¢æˆ·ç«¯ã€‚
ä½¿ç”¨ netcat -lv -p 8881 ç›‘å¬ 127.0.0.1:8881
è®¿é—® http://**.** nc çš„æ•°æ®åŒ…ä¸º: GET http://hyuga.co/ HTTP/1.1 Host: hyuga.co Proxy-Connection: keep-alive Pragma: no-cache Cache-Control: no-cache Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Referer: http://hyuga.co/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 ... è®¿é—® https://**.** nc çš„æ•°æ®åŒ…ä¸º: CONNECT github.com:443 HTTP/1.1 Host: github.com:443 Proxy-Connection: keep-alive User-Agent: Mozilla/5.0 golang å®ç° http(s) ä»£ç†æœåŠ¡å™¨ ä½¿ç”¨éš§é“ç›´æ¥åŒå‘å¤åˆ¶ https æ•°æ®</description></item></channel></rss>